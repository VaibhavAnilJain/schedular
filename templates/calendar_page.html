<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <title></title>
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <script src="https://cdn.jsdelivr.net/npm/fullcalendar@5.9.0/main.min.js"></script>
        <script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
        <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/fullcalendar@5.9.0/main.css">
        <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">
        <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/css/bootstrap.min.css">
        <link rel="stylesheet" type= "text/css" href= "{{ url_for('static',filename='styles/calendar_page.css') }}">
        <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/timepicker/1.3.5/jquery.timepicker.min.css">
        <script src="//cdnjs.cloudflare.com/ajax/libs/timepicker/1.3.5/jquery.timepicker.min.js"></script>
        <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/js/bootstrap.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.29.1/moment.min.js"></script>
        <script>


            document.addEventListener('DOMContentLoaded', function() {
              var calendarEl = document.getElementById('calendar');
              var eventss = [];

              var number = parseInt('{{n}}');
              console.log(typeof number);

              myvar = '{{events|tojson}}';
           
              var parsed = JSON.parse(myvar);
              console.log(parsed);
              

              for(var i =0; i < number; i++) 
                {eventss.push( {title: parsed[i].title, start: parsed[i].start+'T'+parsed[i].startTime, end: parsed[i].end+'T'+parsed[i].endTime })}
              
              console.log(eventss);

              


              var calendar = new FullCalendar.Calendar(calendarEl, {
                height: 650,
                initialView: 'dayGridMonth',
                // initialDate: '2021-07-07',
                selectable: true,
                headerToolbar: {
                  left: 'prev,next today',
                  center: 'title',
                  right: 'dayGridMonth,timeGridWeek,timeGridDay'
                },
                eventClick: function(info) {
                    //alert('Event: ' + moment(info.event.start).format('YYYY-MM-DD'));
                    alert(info.event.end)
                  $("#myModalLabel3").text("Event title "+info.event.title); 
                   $("#myModalLabel2").text("Date "+moment(info.event.start).format('YYYY-MM-DD'));
                   $("#events_descr").modal('show');
                   $("#stdate_").val(moment(info.event.start).format('YYYY-MM-DD'));
                   $("#title_").val(info.event.title);
                   var a = info.event.start;
                   $('#stTime_').val(moment(info.event.start).format('HH:mm'));
                   $('#eTime_').val(moment(info.event.end).format('HH:mm'));
                   $('#eDate_').val(moment(info.event.end).format('YYYY-MM-DD'));
                   console.log(moment(info.event.start).format('HH:mm:ss'));
                    
                },
                dateClick: function(info){
                  $("#myModalLabel").text("Add Events to "+info.dateStr); 
                  $("#exampleModalCenter").modal('show');
                 // $("#myModalLabel2").text("Date "+info.dateStr);
                  $("#dateday").val(info.dateStr);
                  
                  // alert(info.dateStr);
                  // arr=info.dateStr;
                  // $.ajax
                  // ({
                  //     url:'/calendarPage',
                  //     type:'POST',
                  //     data:{'date':info.dateStr},
                  //     success:function(response){
                  //        console.log(response); 
                  //     },
                  //     error: function(error){
                  //       console.log(error);
                  //     }
                  // })
                // },
                // select: function(info) {
                // alert('selected ' + info.startStr + ' to ' + info.endStr);
      },
                events:eventss
                //   {
                //     groupId: '999',
                //     title: 'Repeating Event',
                //     start: '2021-07-09T16:00:00'
                //   },
                //   {
                //     groupId: '999',
                //     title: 'Repeating Event',
                //     start: '2021-07-16T16:00:00'
                //   },
                //   {
                //     title: 'Conference',
                //     start: '2021-07-11',
                //     end: '2021-07-13'
                //   },
                //   {
                //     title: 'Meeting',
                //     start: '2021-07-12T10:30:00',
                //     end: '2021-07-12T12:30:00'
                //   },
                //   {
                //     title: 'Lunch',
                //     start: '2021-07-12T12:00:00'
                //   },
                //   {
                //     title: 'Meeting',
                //     start: '2021-07-12T14:30:00'
                //   },
                //   {
                //     title: 'Birthday Party',
                //     start: '2021-07-13T07:00:00'
                //   },
                //   {
                //     title: 'Click for Google',
                //     url: 'http://google.com/',
                //     start: '2021-07-28'
                //   }
                // ]
              });
          
              calendar.render();
            });
          // Time Picker Initialization
            // $('#input_starttime').pickatime({});
          </script>
    </head>
    <body>


      <div class="navcontainer">
        <nav class="navbar navbar-expand-lg navbar-dark bg-dark">
          <a class="navbar-brand" href="#">Navbar</a>
          <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNavAltMarkup" aria-controls="navbarNavAltMarkup" aria-expanded="false" aria-label="Toggle navigation">
            <span class="navbar-toggler-icon"></span>
          </button>
          <div class="collapse navbar-collapse" id="navbarNavAltMarkup">
            <div class="navbar-nav">
              <a class="nav-item nav-link active" href="#">Home <span class="sr-only">(current)</span></a>
              <a class="nav-item nav-link" href="#">Features</a>
              <a class="nav-item nav-link" href="#">Pricing</a>
              <a class="nav-item nav-link disabled" href="#">Disabled</a>
            </div>
          </div>
        </nav>
      </div>



      <div class="modal fade" id="exampleModalCenter" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
                    <h4 class="modal-title" id="myModalLabel">Add Event to </h4>
                </div>
                <form method="post" action="/getdata">
                    <div class="modal-body">
                        <div class="form-group">
                            <input class="form-control business_skill_id" type="hidden" name="id">
                            <input class="form-control business_skill_name" name="name" placeholder="Enter the Event" required>
                        </div>
                        <div class="form-group">
                            <input class="form-control business_skill_content" type="hidden" name="content">
                            <!-- <label for="heading">Enter program details</label> -->
                            <textarea class="form-control" id="business_skill_content"  name="content1"  placeholder="Enter the Description" rows="4" cols="50" ></textarea>
                        </div>
                      
                        <div class="radio">
                          Type of Events &nbsp;&nbsp;&nbsp;
                          <label class="radio-inline"><input type="radio" name="optradio" value="Indoor">Indoor</label>
                          <label class="radio-inline"><input type="radio" name="optradio" value="Outdoor">Outdoor</label>
                        </div>
                     
                        Enter start time &nbsp;&nbsp;&nbsp;&nbsp;
                          <div class="row">
                             <div class='col-sm-6'>
                                <div class="form-group">
                                   <div class='input-group date' id='datetimepicker3'>
                                      <input type='text' class="form-control" name="stTime">
                                      <span class="input-group-addon">
                                      <span class="glyphicon glyphicon-time"></span>
                                      </span>
                                   </div>
                                </div>
                             </div>
                             <!-- <script type="text/javascript">
                                $(function () {
                                    $('#datetimepicker3').datetimepicker({
                                        format: 'LT'
                                    });
                                });
                             </script> -->
                          </div>

                        <div class = "endDate">
                          <input type='date' class="form-control" id="enddate_" name="enddate_" required>
                        </div>
                        Enter end time &nbsp;&nbsp;&nbsp;&nbsp;
                          <div class="row">
                            <div class='col-sm-6'>
                               <div class="form-group">
                                  <div class='input-group date' id='datetimepicker3'>
                                     <input type='text' class="form-control" name="endTime" >
                                     <span class="input-group-addon">
                                     <span class="glyphicon glyphicon-time"></span>
                                     </span>
                                  </div>
                               </div>
                              </div>
                         </div>
                         <div class = "datte">
                          <input type='hidden' class="form-control" id="dateday" name="dt" >

                         </div>
                    <div class="modal-footer">
                    
                        <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
                        <button type="submit" class="btn btn-primary">Save changes</button>
                    </div>
                  </div>
                </form>
            </div>
        </div>
    </div>

    <!-- Model 2 starts from here for deletion of events -->
    <div class="modal fade" id="events_descr" tabindex="-1" role="dialog" aria-labelledby="myModalLabel1" aria-hidden="true">
      <div class="modal-dialog">
          <div class="modal-content">
              <div class="modal-header">
                  <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
                  
                  <h4 class="modal-title1" id="myModalLabel3">Event: Python Assignment </h4>
              </div>
              <form method="post" action="/deleteData">
                  <div class="modal-body">
                  
                    
                       <h6 class="modal-title1" id="myModalLabel2"></h6>
                       <div class = "startDate_">
                        <input type='hidden' class="form-control" id="stdate_" name="stdate_" >
                       </div>
                       <div class = "titlee">
                        <input type='hidden' class="form-control" id="title_" name="title_" >

                       </div>
                       <div class = "startTime_">
                        <input type='hidden' class="form-control" id="stTime_" name="stTime_" >
                       </div>
                       <div class = "endTime_">
                        <input type='hidden' class="form-control" id="eTime_" name="eTime_" >
                       </div>
                       <div class = "endDate_">
                        <input type='hidden' class="form-control" id="eDate_" name="eDate_" >
                       </div>
                  <div class="modal-footer">
                  
                      <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
                      <button type="submit" class="btn btn-primary">Delete Event</button>
                  </div>
                </div>
              </form>
          </div>
        </div>
    </div>

        
        <!-- <h1> Welcome!'{{n}}'</h1> -->
        <div class="container">
          
          <div id="calendar" ></div>
          <div class = "weather_table">
          <div class='table-responsive' style="overflow-x:auto;" id="tb">
        <!-- <div class="table-responsive"> -->
          <table class="table table-bordered table-dark" id="tb">
            <thead class = "thead-dark">
              <tr>
                
                <th scope="col">Start date</th>
                <th scope="col">Start Time</th>
                <th scope="col">End date</th>
                <th scope="col">End Time</th>
                <th scope="col">Title</th>
                <th scope="col">Description</th>
              </tr>
            </thead>
            <tbody>
              {% for i in data %}
              
              <tr>
                
                <td>{{i.start}}</td>
                <td>{{i.stTimeap}}</td>
                <td>{{i.end}}</td>
                <td>{{i.endTimeap}}</td>
                <td>{{i.title}}</td>
                <td>{{i.des}}</td>

              </tr>
              {% endfor %}
              <!-- <tr>
                <th scope="row">1</th>
                <td>Mark</td>
                <td>Otto</td>
                <td>@mdo</td>
              </tr>
              <tr>
                <th scope="row">2</th>
                <td>Jacob</td>
                <td>Thornton</td>
                <td>@fat</td>
              </tr>
              <tr>
                <th scope="row">3</th>
                <td colspan="2">Larry the Bird</td>
                <td>@twitter</td>
              </tr> -->
            </tbody>
          </table>
        </div>
        <!-- </div> -->
        <div class = "weather_">
        <h3>Temperature: {{weatherData.temp}}&degC</h3>
        <h3>Feels Like: {{weatherData.feels_like}}&degC</h3>
        <h3>Weather: {{weatherData.weather}}   <img src = http://openweathermap.org/img/w/{{weatherData.weatherIcon}}.png></h3>
        <h3>Description: {{weatherData.weather_des}}</h3>
      </div>
        </div>
      </div>
    </body>
</html>